<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>S3 이미지 업로드 테스트</title>
</head>
<body>
<h2>이미지 업로드</h2>
<input type="file" id="fileInput" />
<button onclick="upload()">업로드</button>

<script>
    async function upload() {
        const fileInput = document.getElementById('fileInput');
        if (!fileInput.files.length) {
            alert('파일을 선택해주세요.');
            return;
        }

        const file = fileInput.files[0];
        const fileName = encodeURIComponent(file.name);
        const contentType = encodeURIComponent(file.type);

        try {
            const res = await fetch(`http://localhost:8080/admin-api/s3/presigned-url/${fileName}?contentType=${contentType}`);
            const uploadUrl = await res.text();

            const uploadRes = await fetch(uploadUrl, {
                method: 'PUT',
                headers: {
                    'Content-Type': file.type,
                },
                body: file
            });

            if (uploadRes.ok) {
                alert('업로드 성공!');
                console.log('파일 URL:', uploadUrl.split('?')[0]);
            } else {
                alert('업로드 실패');
            }
        } catch (e) {
            console.error(e);
            alert('에러 발생');
        }
    }
</script>
</body>
</html>
